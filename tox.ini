[tox]
envlist = precommit-tests, py39, py310, py311, py312, codex-gate
skipsdist = true

[testenv:precommit-tests]
description = Pre-commit tests
deps =
    pytest
    duckdb>=0.10
setenv =
    PYTHONDONTWRITEBYTECODE = 1
commands =
    pytest -q -p no:cacheprovider tests

[testenv]
deps =
    pytest
    charset-normalizer>=3.0.0
    chardet>=5.0.0
commands =
    pytest -q

[testenv:codex-gate]
deps =
    pytest
    charset-normalizer>=3.0.0
    chardet>=5.0.0
commands =
    pytest -q \
      tests/test_ingestion_encodings_matrix.py \
      tests/test_ingestion_auto_encoding.py \
      tests/test_ingestion_encoding_coverage.py \
      tests/test_sqlite_pool_close.py \
      tests/test_chat_session_exit.py
