# Auto-generated by codex_logging_workflow.py
import uuid
import sys
from pathlib import Path

sys.path.insert(0, str(Path(__file__).resolve().parents[1]))
from codex.logging.session_logger import log_event, fetch_messages, get_session_id

def test_user_and_assistant_logged_roundtrip(tmp_path, monkeypatch):
    # Use a dedicated session id for isolation
    sid = f"pytest-{uuid.uuid4()}"
    log_event(sid, "user", "hello")
    log_event(sid, "assistant", "world")
    msgs = fetch_messages(sid)
    roles = [m["role"] for m in msgs]
    assert roles == ["user", "assistant"]
    assert msgs[0]["content"] == "hello"
    assert msgs[1]["content"] == "world"
