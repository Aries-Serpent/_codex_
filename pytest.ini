[pytest]
pythonpath =
    .
    src
testpaths = tests
python_files = test_*.py
addopts =
    -q
    -m "not slow"
    -ra
    --disable-warnings
    --strict-markers
    -p pytest_randomly
    --maxfail=1
    --disable-plugin-autoload
    --randomly-seed=123
filterwarnings =
    ignore::DeprecationWarning
    ignore::UserWarning
markers =
    interfaces: tests for interface contracts
    ml: machine-learning tests
    data: data handling tests
    infra: infrastructure tests
    perf: performance tests
    regression: regression tests
    security: security and safety tests
    slow: marks tests as slow (deselect with '-m "not slow"')
    not_slow: tests that are part of the default fast suite
    gpu: tests that require a CUDA-capable GPU (skipped by default in Codex)
    requires_torch: test requires the 'torch' package
    requires_transformers: test requires the 'transformers' package
    requires_sentencepiece: test requires the 'sentencepiece' package
    net: tests that require outbound network access (opt-in via RUN_NET_TESTS=1)
    smoke: hermetic, network-free smoke tests
    asyncio: asynchronous tests that run with pytest-asyncio
    tokenizer: tokenizer-specific tests
    training: training/loop tests
    eval: evaluation tests
    deferred: tests exercising deferred modules (skipped by default)
plugins = pytest_cov, pytest_randomly

# Tip: set PYTEST_DISABLE_PLUGIN_AUTOLOAD=1 to keep startup hermetic; core plugins are pinned above.

; deterministic ordering; override with --randomly-seed <int>
randomly_seed = 123
